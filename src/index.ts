import { Interpreter } from './Interpreter'
import { Parser } from './Parser'
import { DataProvider } from './DataProvider'
import type { 
    Algorithm,
  } from "./types";
import { AlpacaStockClient } from './clients/AlpacaClient';

const algorithmJson = `{"description":"","children":[{"id":"8b9d9b23-bf3a-4459-8e9c-4530c27b9205","step":"wt-cash-equal","suppress-incomplete-warnings?":true,"children":[{"id":"54205094-26a9-4a08-8784-4735d75d40e5","step":"group","name":"Codebreaker (5d Total Market) - SPY 200d MA","children":[{"step":"wt-cash-equal","id":"9b6482cf-0950-47ec-8278-067431f2f311","children":[{"weight":{"num":100,"den":100},"id":"bc5648c6-72a4-4917-b894-e2e85dfe9534","step":"group","name":"CodeBreaker (5d EM) - SPY 200d MA","children":[{"step":"wt-cash-equal","id":"fabc743d-c09c-4342-9112-690bbad61a17","children":[{"weight":{"num":100,"den":100},"id":"95c13ec3-5f31-417c-968e-3f93787dd3bb","step":"if","children":[{"children":[{"id":"f9bd636b-7e01-49ad-a55c-1e5708947833","step":"wt-cash-equal","children":[{"id":"46cd7498-7bc1-4737-a60b-359802f2be7e","step":"group","name":"CodeBreaker (5d EM) - Above 200d MA","children":[{"step":"wt-cash-equal","id":"3b72724d-351a-410a-bf66-5a6c97c04de0","children":[{"id":"5ecaa6fa-f399-4a3a-8bf9-dcb482dfb924","step":"group","name":"LQD > XLG","children":[{"step":"wt-cash-equal","id":"407231d3-7d0d-4b29-b520-e1b935d9f37c","children":[{"id":"e3b7b908-25b3-42aa-aa82-2407f5a267f8","step":"if","children":[{"children":[{"ticker":"EDC","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bull 3x Shares","id":"39a13cf8-9b46-4b35-af9f-32eb1484a47e","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"LQD","id":"127d1f49-768e-4bc0-93c7-49d06f5355ac","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"XLG","step":"if-child"},{"id":"b701052c-bb67-420b-adc8-de38b50a1bcd","step":"if-child","is-else-condition?":true,"children":[{"ticker":"EDZ","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bear 3X Shares","id":"0ba975a7-9dcf-4915-b5a7-63e79fdc0fc9","step":"asset"}]}]}]}],"collapsed?":true},{"id":"6bf9d27f-59ea-414c-bcca-48f0d03540e7","step":"group","name":"BIV > WTV","children":[{"step":"wt-cash-equal","id":"d9dbed67-f1a1-4b73-b8b8-97834a137bca","children":[{"id":"b997431c-dbf8-4be0-b724-f2aa253a602b","step":"if","children":[{"children":[{"ticker":"EDC","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bull 3x Shares","id":"ed3f3743-59d9-4830-895d-51894c689e23","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"BIV","id":"9701de5c-44ff-4aa6-9d86-12aba31a3e89","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"WTV","step":"if-child"},{"id":"189aeb47-f19b-48e9-bf3a-d54efb2bce56","step":"if-child","is-else-condition?":true,"children":[{"ticker":"EDZ","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bear 3X Shares","id":"3cf2321b-2845-497a-8d37-931ac7126801","step":"asset"}]}]}]}],"collapsed?":true},{"id":"808ec17d-c3bf-45c3-bd38-5438190601bd","step":"group","name":"VCIT > IYC","children":[{"step":"wt-cash-equal","id":"d286a02b-3596-4e9f-b75b-1942f49d9ce8","children":[{"id":"be06b0bc-c113-44c1-8ab6-59368a4def01","step":"if","children":[{"children":[{"ticker":"EDC","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bull 3x Shares","id":"f0d047d0-4d30-4cdc-97db-413f80d7ec55","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"VCIT","id":"4be6f2c0-3376-4b79-bf84-5c3b80f70380","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"IYC","step":"if-child"},{"id":"9c7699c4-5bd6-4b46-9d0d-e3aa8e02f37b","step":"if-child","is-else-condition?":true,"children":[{"ticker":"EDZ","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bear 3X Shares","id":"20ac4949-9517-41e8-8ef1-8e994f967af3","step":"asset"}]}]}]}],"collapsed?":true},{"id":"b40b8e6b-d012-4039-91d6-4bb961ec169a","step":"group","name":"XMPT > XLG","children":[{"step":"wt-cash-equal","id":"ba0284c2-9a1b-4fba-a661-f24565fdb177","children":[{"id":"d696368f-389d-4c8c-a738-604d59529022","step":"if","children":[{"children":[{"ticker":"EDC","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bull 3x Shares","id":"ac4af485-1c12-47f8-8c1d-6b8b580d2235","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"XMPT","id":"9d3ebef7-dc29-4c10-9c01-b57e04f1baa0","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"XLG","step":"if-child"},{"id":"9096ae5f-b106-4e04-abc8-4ae87d2e7a14","step":"if-child","is-else-condition?":true,"children":[{"ticker":"EDZ","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bear 3X Shares","id":"3a1a6b8c-677d-4e4f-93c7-abbcd3c9da1e","step":"asset"}]}]}]}],"collapsed?":true}]}],"collapsed?":false}]}],"lhs-fn-params":{},"rhs-fn":"moving-average-price","is-else-condition?":false,"lhs-fn":"current-price","lhs-val":"SPY","id":"10669f95-1717-41c1-a3fd-590ba5acf4a8","rhs-fn-params":{"window":200},"comparator":"gt","rhs-val":"SPY","step":"if-child"},{"id":"65afc79e-338c-405c-a3f0-904047b741a4","step":"if-child","is-else-condition?":true,"children":[{"id":"eb9cda7c-7530-48f7-93d8-d7868e5ea7a8","step":"group","name":"CodeBreaker (5d EM) - Below 200d MA","children":[{"step":"wt-cash-equal","id":"b6499e22-9eaf-487a-80f5-2bc32994b873","children":[{"id":"114f951e-dfdc-45c9-a775-d800a4714dc5","step":"group","name":"AOM > ITOT","children":[{"step":"wt-cash-equal","id":"37f0bdfb-fe64-4199-98d3-85ce2f1acb96","children":[{"id":"acfd8496-b59e-4038-8634-b88b3df6cbba","step":"if","children":[{"children":[{"ticker":"EDC","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bull 3x Shares","id":"98deba1e-2b75-40fa-b6fb-e320c53d86bf","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"AOM","id":"7faf92e7-5753-4cc3-9fbf-de66d56ec30a","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"ITOT","step":"if-child"},{"id":"f563daaa-703f-457e-ad5d-1a54337e4c8e","step":"if-child","is-else-condition?":true,"children":[{"ticker":"EDZ","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bear 3X Shares","id":"c0daa6b3-73ea-4d86-88ba-c002c6cf6182","step":"asset"}]}]}]}],"collapsed?":true},{"id":"1bda57a9-a3f5-44a2-85d3-eda87c595fdf","step":"group","name":"SPEU > SPLG","children":[{"step":"wt-cash-equal","id":"7a4c3fc6-dee7-41aa-8d9d-ae067013c907","children":[{"id":"306bae21-db33-4f96-90b7-99b048d937f1","step":"if","children":[{"children":[{"ticker":"EDC","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bull 3x Shares","id":"17fcc3d6-8c8f-4167-ad82-662b3fceab05","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"SPEU","id":"502c6530-f98d-46af-9761-17fb82203ce5","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"SPLG","step":"if-child"},{"id":"9bcccd95-4d01-4d8b-b23c-85821c17ece2","step":"if-child","is-else-condition?":true,"children":[{"ticker":"EDZ","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bear 3X Shares","id":"1396845d-5aff-4bd6-89ca-99b53ff6a2a0","step":"asset"}]}]}]}],"collapsed?":true},{"id":"6cc6f520-8527-4180-a58b-4d70cf3eacca","step":"group","name":"EFA > SPXL","children":[{"step":"wt-cash-equal","id":"f27c21a6-0ac2-4e06-acb0-d477c40b59f4","children":[{"id":"186878d0-91cf-4951-8455-74e80f85dfd0","step":"if","children":[{"children":[{"ticker":"EDC","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bull 3x Shares","id":"b53b0a0b-c0b0-4248-92c0-f9ba50133aa4","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"EFA","id":"18c212c3-8a05-42da-a24f-f2afa248a5a2","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"SPXL","step":"if-child"},{"id":"f94663ad-0d01-4973-98cb-39534d68123e","step":"if-child","is-else-condition?":true,"children":[{"ticker":"EDZ","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bear 3X Shares","id":"5183a0bb-0ad1-4874-a964-80f0bde4f276","step":"asset"}]}]}]}],"collapsed?":true},{"id":"48821aff-9941-4cc3-b86d-407ee9a54666","step":"group","name":"EMB > UWM","children":[{"step":"wt-cash-equal","id":"372861c2-99d5-485a-ab05-88a357d7a121","children":[{"id":"ef64f169-2633-405e-8642-ba9bcd8949e6","step":"if","children":[{"children":[{"ticker":"EDC","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bull 3x Shares","id":"33526eaa-c8b3-46f8-893c-63850924b968","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"EMB","id":"3debcd37-a9db-4f9f-8f8a-8cffee67a4b8","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"UWM","step":"if-child"},{"id":"cb3398f4-3f32-4311-ab94-e3b870ad8eb1","step":"if-child","is-else-condition?":true,"children":[{"ticker":"EDZ","exchange":"ARCX","name":"Direxion Daily MSCI Emerging Markets Bear 3X Shares","id":"c89e9bee-60c6-4eed-826f-b174cc589a08","step":"asset"}]}]}]}],"collapsed?":true}]}],"collapsed?":false}]}]}]}],"collapsed?":true},{"weight":{"num":100,"den":100},"id":"37560a87-3658-4433-a082-299b2a545da8","step":"group","name":"CodeBreaker (5d IWM) - SPY 200d MA","children":[{"step":"wt-cash-equal","id":"e4ee808f-d057-48d0-8c81-427b47e41f4b","children":[{"weight":{"num":100,"den":100},"id":"5b22a88c-82c5-44f7-8d20-5fb281810650","step":"if","children":[{"children":[{"id":"679a0ba1-8355-4e12-870d-b414c5962a34","step":"wt-cash-equal","children":[{"id":"170a7ea9-1b2a-4d41-a576-c9230ce11281","step":"group","name":"CodeBreaker (5d IWM) - Above 200d MA","children":[{"step":"wt-cash-equal","id":"5e83b804-a376-479b-a4e7-05f39817267b","children":[{"id":"69d33f2f-320e-428f-932f-65f978d8071d","step":"group","name":"XMPT > XLG","children":[{"step":"wt-cash-equal","id":"d0a4bc44-53ba-436b-b2ad-1325178296ad","children":[{"id":"bc606d71-22c2-4a9b-9765-cae990f45826","step":"if","children":[{"children":[{"ticker":"URTY","exchange":"ARCX","name":"ProShares UltraPro Russell2000","id":"2752bcac-90b7-4d66-8b40-ea7ceb55f9e9","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"XMPT","id":"910cf444-228f-4538-9122-2f9370fc5a3e","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"XLG","step":"if-child"},{"id":"6eb23d43-1085-47de-ab52-98cb35dee642","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SRTY","exchange":"ARCX","name":"ProShares UltraPro Short Russell2000","id":"ff812645-61ec-488f-912a-d81209401879","step":"asset"}]}]}]}],"collapsed?":true},{"id":"a6884e09-42ea-4104-91ff-ec5ecbac3198","step":"group","name":"XMPT > IOO","children":[{"step":"wt-cash-equal","id":"444e7f89-953c-4f69-a64e-14acefcffe4e","children":[{"id":"c226d153-221f-4699-8146-66a741d26c90","step":"if","children":[{"children":[{"ticker":"URTY","exchange":"ARCX","name":"ProShares UltraPro Russell2000","id":"81589609-a67e-43cc-891b-d468e2648db2","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"XMPT","id":"0668bbc8-de57-4eb6-888a-5cdc30ff7685","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"IOO","step":"if-child"},{"id":"175f1087-c21d-404e-a704-3941609578b5","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SRTY","exchange":"ARCX","name":"ProShares UltraPro Short Russell2000","id":"efa509cc-862d-4c7c-bfe5-cf3d98aa6701","step":"asset"}]}]}]}],"collapsed?":true},{"id":"9ad426ab-857a-42f7-82af-37b6811a26d0","step":"group","name":"XMPT > WTV","children":[{"step":"wt-cash-equal","id":"16021442-af3b-4d7d-916a-211fac321bd2","children":[{"id":"44fbeb08-e896-4da8-b7ca-a372ae49b381","step":"if","children":[{"children":[{"ticker":"URTY","exchange":"ARCX","name":"ProShares UltraPro Russell2000","id":"a7f9e10a-a1a5-43bd-9c4b-7ab6ec74cd86","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"XMPT","id":"648b22aa-45ef-401f-ac31-bd5685ce6aed","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"WTV","step":"if-child"},{"id":"812cfc7e-8b60-420f-8d6b-00b50a7f08c5","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SRTY","exchange":"ARCX","name":"ProShares UltraPro Short Russell2000","id":"17160c2f-7675-406c-9c85-7005c090ea02","step":"asset"}]}]}]}],"collapsed?":true},{"id":"94a45b27-2678-4ab7-99f7-5ef888c161bd","step":"group","name":"XMPT > RSPS","children":[{"step":"wt-cash-equal","id":"f8400120-361a-457c-bf5c-9bb096171676","children":[{"id":"c4958ddc-cc80-4d70-b610-5b544076d01e","step":"if","children":[{"children":[{"ticker":"URTY","exchange":"ARCX","name":"ProShares UltraPro Russell2000","id":"12f9ab91-a9ee-4a94-b796-306c42338d96","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"XMPT","id":"2c9d2d43-54fd-4877-8eea-40c42d11f1ae","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"RSPS","step":"if-child"},{"id":"e9a69d9d-d967-4935-8182-b179ef83c0b0","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SRTY","exchange":"ARCX","name":"ProShares UltraPro Short Russell2000","id":"ce16c52c-753b-4df2-8180-4c732fb1c542","step":"asset"}]}]}]}],"collapsed?":true}]}],"collapsed?":false}]}],"lhs-fn-params":{},"rhs-fn":"moving-average-price","is-else-condition?":false,"lhs-fn":"current-price","lhs-val":"SPY","id":"264a1ec8-e0ca-40ee-a28d-d13d3e81f337","rhs-fn-params":{"window":200},"comparator":"gt","rhs-val":"SPY","step":"if-child"},{"id":"da67cc78-bfb3-47ef-8a70-efde32d08d08","step":"if-child","is-else-condition?":true,"children":[{"id":"81077579-5de5-488e-9f3e-46c7663b75d1","step":"group","name":"CodeBreaker (5d IWM) - Below 200d MA","children":[{"step":"wt-cash-equal","id":"fd8431b2-a09e-4ad4-aa23-7459ee476d37","children":[{"id":"db055bc8-737f-4e93-83b0-dbc442b718b9","step":"group","name":"TDTF > FCA","children":[{"step":"wt-cash-equal","id":"e8c65bfb-b23f-4907-b53e-6394c613811e","children":[{"id":"ff9bd764-71d2-4800-9207-05f872783086","step":"if","children":[{"children":[{"ticker":"URTY","exchange":"ARCX","name":"ProShares UltraPro Russell2000","id":"96d8aff2-0b77-473c-aa56-c8be25587238","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"TDTF","id":"52bfcb8e-3939-46ec-a625-68bba2b2d9fd","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"FCA","step":"if-child"},{"id":"cfc22a12-b928-4f12-812a-e10d8b5a747d","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SRTY","exchange":"ARCX","name":"ProShares UltraPro Short Russell2000","id":"1b96907f-00f9-49fa-83e4-69ad88b24676","step":"asset"}]}]}]}],"collapsed?":true},{"id":"e79a304a-172b-4fbe-be66-4f89f77cd5a9","step":"group","name":"PFIG > IDU","children":[{"step":"wt-cash-equal","id":"1de9f64f-1f5e-4d7f-aeb2-f50596535d91","children":[{"id":"9017f9bf-7c76-4e1c-8805-9d9012db25da","step":"if","children":[{"children":[{"ticker":"URTY","exchange":"ARCX","name":"ProShares UltraPro Russell2000","id":"7667a756-464e-4947-98e2-046275de0060","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"PFIG","id":"d84a7479-8a54-4ab1-bc0a-29c17c60e793","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"IDU","step":"if-child"},{"id":"def96f1f-9d1c-44c1-abf6-aca32dd866d3","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SRTY","exchange":"ARCX","name":"ProShares UltraPro Short Russell2000","id":"c3f88c05-7d43-4c42-be89-bf8227ed2ccf","step":"asset"}]}]}]}],"collapsed?":true},{"id":"1c252dcd-8aca-42c7-8fd3-aa59baea6235","step":"group","name":"FXZ > IVOG","children":[{"step":"wt-cash-equal","id":"18fcb79a-8cf4-4061-8fdf-dbcd53defbda","children":[{"id":"ec5163b2-a515-4dce-83b8-16ad2d64e7a9","step":"if","children":[{"children":[{"ticker":"URTY","exchange":"ARCX","name":"ProShares UltraPro Russell2000","id":"f86e91b5-e3c9-41df-a614-07968eea6482","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"FXZ","id":"6aff2ec0-c08a-4590-a7e1-e246c55ec6d0","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"IVOG","step":"if-child"},{"id":"42b12b47-97e7-45b8-abff-9e54e9602c11","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SRTY","exchange":"ARCX","name":"ProShares UltraPro Short Russell2000","id":"c496de1f-98bf-4787-9b75-ab6b0e3ffff5","step":"asset"}]}]}]}],"collapsed?":true},{"id":"937c5bd8-2cdb-4c17-bb0e-4f1a55f73c74","step":"group","name":"SCHP > XPP","children":[{"step":"wt-cash-equal","id":"6b66a403-0f03-4043-997c-bf0d3fe3701e","children":[{"id":"bf8773ee-69cc-4312-a594-80fe239582b9","step":"if","children":[{"children":[{"ticker":"URTY","exchange":"ARCX","name":"ProShares UltraPro Russell2000","id":"0259eb9a-ed9f-44df-a6e3-3e6769d57145","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"SCHP","id":"dade4e8f-f8b2-4f3e-8e51-97ba0541a102","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"XPP","step":"if-child"},{"id":"dee3fbfa-c3ad-45ba-9f55-24a1bb345121","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SRTY","exchange":"ARCX","name":"ProShares UltraPro Short Russell2000","id":"7983c2cf-32db-47e8-b4c1-5223b55d9723","step":"asset"}]}]}]}],"collapsed?":true}]}],"collapsed?":false}]}]}]}],"collapsed?":true},{"weight":{"num":100,"den":100},"id":"3a1dd56b-3009-413a-af75-00c1341e05a8","step":"group","name":"CodeBreaker (5d QQQ) - SPY 200d MA","children":[{"step":"wt-cash-equal","id":"06bacef2-21ab-4404-b7af-21e4da03d2a9","children":[{"weight":{"num":100,"den":100},"id":"1a9c3fdf-8201-4ddb-93ce-a815669274b2","step":"if","children":[{"children":[{"id":"758e0f66-719d-484e-b11d-a840a7fa486c","step":"wt-cash-equal","children":[{"id":"5d1c8ee0-5cd4-4ee5-a217-6aa023ee3a18","step":"group","name":"CodeBreaker (5d QQQ) - Above 200d MA","children":[{"step":"wt-cash-equal","id":"03940c99-f6bc-430e-a894-0b1b85c5daa3","children":[{"id":"facb7f48-02c4-4c79-b679-8a4fd068b9c5","step":"group","name":"PFF > IHF","children":[{"step":"wt-cash-equal","id":"9c0bce07-9045-4d2d-8d76-19a518b0c1d2","children":[{"id":"d21d2979-4435-4a9d-a28b-0081e06d786a","step":"if","children":[{"children":[{"ticker":"TQQQ","exchange":"XNAS","name":"ProShares UltraPro QQQ","id":"deda36b9-273e-4518-80f7-6996a0842faa","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"PFF","id":"68a71e04-6691-40aa-8e62-441144ea5924","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"IHF","step":"if-child"},{"id":"acc0c011-1114-4f69-b86a-081c9f0fa30c","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SQQQ","exchange":"XNAS","name":"ProShares UltraPro Short QQQ","id":"60f0ff4b-08e1-4162-8e10-8b060ba963f5","step":"asset"}]}]}]}],"collapsed?":true},{"id":"ba566da6-efd0-41ea-a78b-38d3e24e198c","step":"group","name":"XMPT > SCHB","children":[{"step":"wt-cash-equal","id":"466fc711-75d0-419a-81c4-56aa20548c65","children":[{"id":"5c631a84-55c1-4589-a3e6-c6114435a9f8","step":"if","children":[{"children":[{"ticker":"TQQQ","exchange":"XNAS","name":"ProShares UltraPro QQQ","id":"d6b8c2a8-32e6-4529-9adc-690c892f3818","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"XMPT","id":"fab5aba6-c40f-4924-8ef0-f1f05c75de8e","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"SCHB","step":"if-child"},{"id":"be38e26c-2e28-47d0-8256-b0dcf7b31bf9","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SQQQ","exchange":"XNAS","name":"ProShares UltraPro Short QQQ","id":"22ce95e5-c69a-4f90-b930-c0d15614ed81","step":"asset"}]}]}]}],"collapsed?":true},{"id":"16fbb112-cee8-4785-9536-fca9a26aad00","step":"group","name":"XMPT > VONE","children":[{"step":"wt-cash-equal","id":"4ab318ad-3265-4e7a-9178-1a027e0bb8f2","children":[{"id":"c8c4a56c-82d6-4e94-aa91-d016ba1088b3","step":"if","children":[{"children":[{"ticker":"TQQQ","exchange":"XNAS","name":"ProShares UltraPro QQQ","id":"34a8e4f5-cb2f-4afb-8dc2-4ace48b3d6f9","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"XMPT","id":"2a8651c8-c7b2-4f76-a6fc-b42c65968029","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"VONE","step":"if-child"},{"id":"0d465b10-a0d1-4999-bc93-522f0145e5f0","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SQQQ","exchange":"XNAS","name":"ProShares UltraPro Short QQQ","id":"20b19a87-8739-4bad-91a3-732a3d08c72c","step":"asset"}]}]}]}],"collapsed?":true}]}],"collapsed?":false}]}],"lhs-fn-params":{},"rhs-fn":"moving-average-price","is-else-condition?":false,"lhs-fn":"current-price","lhs-val":"SPY","id":"1e94ccdc-a762-4b39-a679-8fd3db90e72c","rhs-fn-params":{"window":200},"comparator":"gt","rhs-val":"SPY","step":"if-child"},{"id":"b7226327-5af8-4f6f-8a6b-84337f128b6b","step":"if-child","is-else-condition?":true,"children":[{"id":"2663ed4a-4daa-4d72-b8eb-c30809640fed","step":"group","name":"CodeBreaker (5d QQQ) - Below 200d MA","children":[{"step":"wt-cash-equal","id":"6dd4b2d9-2d91-4508-8f4d-f7d773048198","children":[{"id":"0a25268f-935b-4859-8ee3-3d576644f56b","step":"group","name":"SMB > EQWL","children":[{"step":"wt-cash-equal","id":"dd307cd8-e92c-407b-b614-92cd075544f2","children":[{"id":"8b4d30c2-13f8-42bd-9a93-020f96d3695f","step":"if","children":[{"children":[{"ticker":"TQQQ","exchange":"XNAS","name":"ProShares UltraPro QQQ","id":"3477493c-a04b-4547-add1-87a42087c8b9","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"SMB","id":"cf8b9c39-3388-4047-aa68-86356487270b","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"EQWL","step":"if-child"},{"id":"43f20c0d-cf50-4da6-a54a-9c81188d65ff","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SQQQ","exchange":"XNAS","name":"ProShares UltraPro Short QQQ","id":"585156cf-1a4a-4afc-89fa-ad3ddf2bef76","step":"asset"}]}]}]}],"collapsed?":true},{"id":"893c6a25-8986-4c6f-8f97-3afb4625afa1","step":"group","name":"SMB > MGC","children":[{"step":"wt-cash-equal","id":"c7a6fa8d-0269-4736-b634-d89fb7846089","children":[{"id":"0636c81a-5c71-4847-82b0-b44d50a5c2f3","step":"if","children":[{"children":[{"ticker":"TQQQ","exchange":"XNAS","name":"ProShares UltraPro QQQ","id":"8a4511fa-1937-44f3-88c3-8f7a7f233024","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"SMB","id":"0af6cf0a-833a-4b3f-92d0-b3306068a42f","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"MGC","step":"if-child"},{"id":"fd4c67f4-93cf-432a-a4b8-025a82c254b1","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SQQQ","exchange":"XNAS","name":"ProShares UltraPro Short QQQ","id":"3b66087e-a0c9-457e-a37d-c7ea0ee3c887","step":"asset"}]}]}]}],"collapsed?":true},{"id":"d1047985-fbe8-4f7c-ba32-54d503ac7227","step":"group","name":"SMB > IOO","children":[{"step":"wt-cash-equal","id":"bbb6a639-e108-4567-9362-f67975bef623","children":[{"id":"08cf97ec-1f46-4455-b1a2-3685ec726fbe","step":"if","children":[{"children":[{"ticker":"TQQQ","exchange":"XNAS","name":"ProShares UltraPro QQQ","id":"bb3180fc-faad-4ac4-b6c9-958141337c63","step":"asset"}],"lhs-fn-params":{"window":5},"rhs-fn":"relative-strength-index","is-else-condition?":false,"lhs-fn":"relative-strength-index","lhs-val":"SMB","id":"a9c27186-03a5-44fc-983d-1830e4bcdef8","rhs-fn-params":{"window":5},"comparator":"gt","rhs-val":"IOO","step":"if-child"},{"id":"dea677d1-989f-43f3-a215-bac909045cd9","step":"if-child","is-else-condition?":true,"children":[{"ticker":"SQQQ","exchange":"XNAS","name":"ProShares UltraPro Short QQQ","id":"d0f7a909-7cce-40ba-b8a2-0c92a7b11f1a","step":"asset"}]}]}]}],"collapsed?":true}]}],"collapsed?":false}]}]}]}],"collapsed?":true}]}]}]}],"suppress-incomplete-warnings?":false,"name":"New Symphony","asset_class":"EQUITIES","rebalance":"daily","id":"new","step":"root","asset_classes":["EQUITIES"]}`;

const algorithm: Algorithm = JSON.parse(algorithmJson);
const parser = new Parser()

const indicators = parser.parseIndicators(algorithm)

const alpacaClient = new AlpacaStockClient()

const dataProvider = new DataProvider(alpacaClient, indicators)
await dataProvider.load()

// const interpreter = new Interpreter(dataProvider)

// const allocations = interpreter.evaluate(algorithm)

// console.log(allocations);